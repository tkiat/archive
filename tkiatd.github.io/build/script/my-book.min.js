"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,o){return e&&_defineProperties(t.prototype,e),o&&_defineProperties(t,o),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _createSuper(o){var r=_isNativeReflectConstruct();return function(){var t,e=_getPrototypeOf(o);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments))}}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var o="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(t))return o.get(t);o.set(t,e)}function e(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(e,t)})(t)}function _construct(t,e,o){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,e,o){var r=[null];r.push.apply(r,e);var n=new(Function.bind.apply(t,r));return o&&_setPrototypeOf(n,o.prototype),n}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var BlogBook=function(){_inherits(l,_wrapNativeSuper(HTMLElement));var s=_createSuper(l);function l(t,e,o,r,n){var i;_classCallCheck(this,l),(i=s.call(this)).dataset.bookTitle=t,i.chapters=e,i.articles=o,i.bgColor=r,i.sortDirection=-1,i.classList.add("book");var a=document.createElement("div");a.classList.add("book-cover"),i.appendChild(a);var c=document.createElement("div");return c.classList.add("book-content"),i.appendChild(c),i.insertBookCoverContent(),i.setBookOffset(n),i.switchBookContent("cover"),i}return _createClass(l,[{key:"createBookmark",value:function(e,t,o,r,n){var i=this,a=document.createElement("a");return a.classList.add("bookmark"),a.classList.add("bookmark--active"),a.dataset.chapter=e,a.setAttribute("href","javascript:void(0)"),a.style.height=r+"em",a.style.left=t+"px",a.style.paddingBottom=r*(n-1)+"em",a.style.paddingLeft=o+"px",a.style.paddingRight=o+"px",a.style.top=-r*n+"em",a.style.zIndex=9-n,a.textContent=e,a.addEventListener("click",function(){i.querySelectorAll(".bookmark").forEach(function(t){t.classList.remove("bookmark--opened")}),a.classList.add("bookmark--opened");var t="All Chapters"===e?i.articles:i.articles.filter(function(t){return t.chapter===e});stateBtoB(e,t)}),a}},{key:"insertBookCoverContent",value:function(){var t=document.createElement("div");t.classList.add("book-cover__upper"),t.innerHTML="<img class='book-cover__upper-img' src='http://localhost:3000/Image/".concat(this.dataset.bookTitle,".svg' alt='image'>"),t.style.backgroundColor=this.bgColor;var e=document.createElement("div");e.classList.add("book-cover__lower");var o="<div class='book-cover__lower-title'>".concat(this.dataset.bookTitle,"</div>");o+='<ul class="book-cover__lower-list">';for(var r=0;r<this.chapters.length;++r){if(3===r&&4<this.chapters.length){o+="<li>etc.</li>";break}o+="<li>".concat(this.chapters[r],"</li>")}o+="</ul>",e.innerHTML=o;var n=this.querySelector(".book-cover");n.appendChild(t),n.appendChild(e)}},{key:"insertBookmarks",value:function(t){var r=0<arguments.length&&void 0!==t?t:function(){},n=this,i=0,a=1,c=10*a,s=["All Chapters"].concat(_toConsumableArray(this.chapters));s.forEach(function(e,o){setTimeout(function(){var t=n.createBookmark(e,c,5,2.3,a);n.appendChild(t),t.offsetLeft+t.clientWidth>document.documentElement.clientWidth-20&&(c=10*++a,t.remove(),t=n.createBookmark(e,c,5,2.3,a),n.appendChild(t)),c+=t.clientWidth+5,o===s.length-1&&r()},1e3*i),i+=.2})}},{key:"removeAllBookmarks",value:function(){for(;this.querySelector(".bookmark");)this.removeChild(this.querySelector(".bookmark"))}},{key:"setBookOffset",value:function(t){this.style.left=20*t+"px",this.style.bottom=10*t+"px"}},{key:"switchBookContent",value:function(t){this.querySelector(".book-content").style.display="content"===t?"block":"none",this.querySelector(".book-cover").style.display="cover"===t?"block":"none"}}]),l}();customElements.define("blog-book",BlogBook);
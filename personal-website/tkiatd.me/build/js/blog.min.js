"use strict";function ownKeys(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,r)}return o}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){_defineProperty(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,o){return t&&_defineProperties(e.prototype,t),o&&_defineProperties(e,o),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _wrapNativeSuper(e){var o="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(e,t,o){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(e,t,o){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return o&&_setPrototypeOf(n,o.prototype),n}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MyBook=function(e){function l(e,t,o,r,n){var a;_classCallCheck(this,l),(a=_possibleConstructorReturn(this,_getPrototypeOf(l).call(this))).category=e,a.topics=t,a.articles=o,a.bgColor=r,a.isMouseOverBook=!1,a.isMouseOverBookmarkCategory=!1,a.sortDirection=1,a.classList.add("book"),a.dataset.category=e;var c=document.createElement("div");c.classList.add("book-cover"),a.appendChild(c);var i=document.createElement("div");return i.classList.add("book-content"),a.appendChild(i),a.appendChild(a.createBookmarkCategory(n)),a.insertBookCoverContent(),a.setBookOffset(n),a.updateBookContent("cover"),a.addEventListener("mouseout",function(){this.isMouseOverBook=!1}),a.addEventListener("mouseover",function(){this.isMouseOverBook=!0}),a}return _inherits(l,_wrapNativeSuper(HTMLElement)),_createClass(l,[{key:"createBookmarkCategory",value:function(e){var t=this,o=this.category,r=document.createElement("a");return r.classList.add("bookmark__category"),r.setAttribute("href","javascript:void(0);"),r.style.top=3.5*e+"em",r.textContent=decodeURIComponent(decodeURIComponent(o)),r.dataset.category=o,r.addEventListener("mouseenter",function(){t.isMouseOverBookmarkCategory=!0,r.textContent="← Open";var e=_toConsumableArray(t.parentNode.children);e.indexOf(t)!==e.length-1&&moveBookToTop(o)}),r.addEventListener("mouseleave",function(){t.isMouseOverBookmarkCategory=!1}),r.addEventListener("click",function(){var e=_toConsumableArray(t.parentNode.children);e.indexOf(t)!==e.length-1&&moveBookToTop(o),history.replaceState(null,null,"/blog/"+o),fromCategoryToTopicPage()}),r}},{key:"createBookmarkTopic",value:function(t,e,o,r,n){var a=this,c=this.category,i=document.createElement("a");return i.classList.add("bookmark__topic"),i.classList.add("bookmark__topic--active"),i.dataset.topic=t,i.setAttribute("href","javascript:void(0)"),i.style.height=r+"em",i.style.left=e+"px",i.style.paddingBottom=r*(n-1)+"em",i.style.paddingLeft=o+"px",i.style.paddingRight=o+"px",i.style.top=-r*n+"em",i.style.zIndex=999-n,i.textContent=t===c?"All topics":decodeURIComponent(decodeURIComponent(t)),i.addEventListener("click",function(){history.replaceState(null,null,"/blog/"+c+"/"+t),a.updateBookContent("content"),a.querySelectorAll(".bookmark__topic").forEach(function(e){e.classList.remove("bookmark__topic--opened")}),i.classList.add("bookmark__topic--opened");var e=t===c?a.articles:a.articles.filter(function(e){return e.topic===t});a.insertArticlesTable(t,e)}),i}},{key:"insertArticlesTable",value:function(a,e){var t=this,c=this.category,o=this,r=document.createElement("table");r.classList.add("book-table"),r.innerHTML="\n\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class='book-table__title' colspan='2'>\n\t\t\t\t\t\t".concat(decodeURIComponent(decodeURIComponent(a)),"\n\t\t\t\t\t</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr class='book-table__header'>\n\t\t\t\t\t<th class='book-table__header-item book-table__header-date'><a>Updated</a><span class='book-table__header-icon'></span></th>\n\t\t\t\t\t<th class='book-table__header-item book-table__header-title'><a>Title</a><span class='book-table__header-icon'></span></th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t<tbody></tbody>\n\t\t"),r.querySelectorAll(".book-table__header-icon").forEach(function(e){e.innerHTML=0<t.sortDirection?"&#x25BE":"&#x25B4"}),r.querySelector(".book-table__header-date").addEventListener("click",function(){o.insertArticlesTable(a,o.sortArticles(e,"date"))}),r.querySelector(".book-table__header-title").addEventListener("click",function(){o.insertArticlesTable(a,o.sortArticles(e,"title"))});var i=r.querySelector("tbody");e.forEach(function(e){var t="/article/"+c+"/"+e.topic+"/"+dateTo_YYYY_MM_DD(e.date)+"-"+e.title+"."+e.ext,o="/blog/".concat(c,"/").concat(e.topic,"/").concat(e.title),r=document.createElement("tr");r.classList.add("book-table__row"),r.innerHTML="\n\t\t\t\t<td class='book-table__row-item book-table__row-date'>".concat(dateTo_YYYY_Mon_DD(e.date),"</td>\n\t\t\t\t<td>").concat(c===a?decodeURIComponent(decodeURIComponent(e.topic))+" -":"","<a class='book-table__row-item book-table__row-title' href='javascript:void(0);'>").concat(decodeURIComponent(decodeURIComponent(e.title)),"</a></td>\n\t\t\t");var n=r.querySelector(".book-table__row-title");n.addEventListener("click",function(){fromTopicToArticlePage(o,t,c,e)}),pathname_article&&e.title===pathname_article&&n.click(),i.appendChild(r)});var n=this.querySelector(".book-content");n.textContent="",n.appendChild(r)}},{key:"insertBookmarkTopics",value:function(r){var n=this,e=0,a=1,c=10*a,i=[this.category].concat(_toConsumableArray(this.topics));i.forEach(function(t,o){setTimeout(function(){var e=n.createBookmarkTopic(t,c,5,2.3,a);n.appendChild(e),e.offsetLeft+e.clientWidth>document.documentElement.clientWidth-20&&(c=10*++a,e.remove(),e=n.createBookmarkTopic(t,c,5,2.3,a),n.appendChild(e)),c+=e.clientWidth+5,o===i.length-1&&r()},1e3*e),e+=.2})}},{key:"insertBookCoverContent",value:function(){var e=this.category,t=document.createElement("div"),o=document.createElement("div");t.classList.add("book-cover__upper"),o.classList.add("book-cover__lower"),t.innerHTML="<img class='book-cover__upper-img' src='/static/img/blog-category/".concat(e,".svg' alt='image'>");var r="<div class='book-cover__lower-title'>".concat(decodeURIComponent(decodeURIComponent(e)),"</div>");r+='<ul class="book-cover__lower-list">';for(var n=this.topics,a=0;a<n.length;++a){if(3===a&&4<n.length){r+="<li>etc.</li>";break}r+="<li>".concat(decodeURIComponent(decodeURIComponent(n[a])),"</li>")}r+="</ul>",o.innerHTML=r,t.style.backgroundColor=this.bgColor;var c=this.querySelector(".book-cover");c.appendChild(t),c.appendChild(o)}},{key:"setBookOffset",value:function(e){this.style.left=20*e+"px",this.style.bottom=10*e+"px"}},{key:"sortArticles",value:function(e,t){return this.sortDirection*=-1,"date"===t?this.sortArticlesByDate(e,this.sortDirection):"title"===t?this.sortArticlesByTitle(e,this.sortDirection):void 0}},{key:"sortArticlesByDate",value:function(e,o){return e=e.sort(function(e,t){return(new Date(e.date)-new Date(t.date))*o})}},{key:"sortArticlesByTitle",value:function(e,n){return e=e.sort(function(e,t){var o=e.title.toLowerCase(),r=t.title.toLowerCase();return o==r?0:r<o?n:-n})}},{key:"updateBookContent",value:function(e){this.querySelector(".book-content").style.display="content"===e?"block":"none",this.querySelector(".book-cover").style.display="cover"===e?"block":"none"}}]),l}();customElements.define("my-book",MyBook);var pathname=window.location.pathname.split("/").slice(2),pathname_category=pathname[0],pathname_topic=pathname[1],pathname_article=pathname[2],blog_title=document.getElementById("blog-title"),menu_main=document.getElementById("menu-main"),bookshelf=document.getElementById("bookshelf"),backbtn=bookshelf.querySelector(".bookshelf__backbtn"),book_list=bookshelf.querySelector(".bookshelf__list");backbtn.addEventListener("click",function(){backbtn.classList.remove("bookshelf__backbtn--active"),fromTopicToCategoryPage()});var article_page=document.getElementById("article");article_page.querySelector(".article__backbtn").addEventListener("click",fromArticleToTopicPage);var books,article_inner=article_page.querySelector(".article__inner"),article_page_content=article_page.querySelector(".article__content"),dropdown_text=document.getElementById("dropdown-text"),categoryToTopicMap={},categoryToArticleMap={},categoryToBookColorMap={},currentPage="category";function checkCategoryURL(){for(var e=0;e<books.length;++e){if(books[e].dataset.category===pathname_category){books[e].querySelector(".bookmark__category").click();break}e===books.length-1&&history.replaceState(null,null,"/blog/")}}function checkTopicURL(e){var t=e.querySelectorAll(".bookmark__topic");if(pathname_topic)for(var o=0;o<t.length;++o)if(t[o].dataset.topic===pathname_topic)return void t[o].click();t[0].click()}function createDropdown(){var t=document.createElement("dropdown-text");return t.setAttribute("data-list",Object.keys(categoryToTopicMap).filter(function(e){return e!==pathname_category}).map(function(e){return decodeURIComponent(decodeURIComponent(e))}).join(",")),t.addEventListener("click",function(){var e=bookshelf.style.opacity;"0.2"===e&&(window.history.replaceState(null,null,"/blog/"+Object.keys(categoryToTopicMap).filter(function(e){return decodeURIComponent(decodeURIComponent(e))===t.getAttribute("value")})[0]),window.location.reload(!1)),bookshelf.style.opacity="0.2"===e?"initial":"0.2"}),t}function dateTo_YYYY_MM_DD(e){return e.getFullYear()+"_"+("0"+(e.getMonth()+1)).slice(-2)+"_"+("0"+e.getDate()).slice(-2)}function dateTo_YYYY_Mon_DD(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()}function fromArticleToTopicPage(){currentPage="topic";var e=window.location.href.substring(0,window.location.href.lastIndexOf("/"));history.replaceState(null,null,e),pathname_article="",article_page.classList.add("article--appear"),article_page_content.textContent="",article_page.classList.remove("article--visible"),dropdown_text.classList.add("dropdown-text--active"),bookshelf.style.display="block",setTimeout(function(){article_page.classList.remove("article--appear"),currentPage="topic"},1e3)}function fromCategoryToTopicPage(){var e=books[books.length-1],t=e.querySelector(".bookmark__category");"topic"!==currentPage&&(currentPage="topic",book_list.classList.add("bookshelf__list--active"),menu_main.style.display="none",setTimeout(function(){e.parentNode.querySelectorAll(".bookmark__category").forEach(function(e){e===t?e.classList.add("bookmark__category--active"):e.style.display="none"}),dropdown_text.classList.add("dropdown-text--active")},0),e.insertBookmarkTopics(function(){blog_title.style.display="none",backbtn.classList.add("bookshelf__backbtn--active"),checkTopicURL(e)}))}function fromTopicToArticlePage(e,t,o,r){"article"!==currentPage&&(currentPage="article",modifyArticle(o,r),history.replaceState(null,null,e),dropdown_text.classList.remove("dropdown-text--active"),article_page.classList.add("article--appear"),setTimeout(function(){article_page.classList.add("article--visible"),fetch(t,{method:"GET",mode:"no-cors"}).then(function(e){return e.text()}).then(function(e){article_page_content.innerHTML=marked(e),bookshelf.style.display="none",insertArticleExpandBtn(),getSessionStorages()}).catch(function(e){return console.error("Error: "+e)})},0))}function fromTopicToCategoryPage(){history.replaceState(null,null,"/blog");var e=books[books.length-1],t=e.querySelectorAll(".bookmark__topic");t.forEach(function(e){e.classList.remove("bookmark__topic--active")}),setTimeout(function(){t.forEach(function(e){e.parentNode.removeChild(e)}),e.updateBookContent("cover"),e.querySelector(".bookmark__category").classList.remove("bookmark__category--active"),e.parentNode.querySelectorAll(".bookmark__category").forEach(function(e){e.style.display="block"}),book_list.classList.remove("bookshelf__list--active"),blog_title.style.display="block",dropdown_text.classList.remove("dropdown-text--active"),menu_main.style.display="block",currentPage="category"},500)}function getColorTheme(){var e,t,o,r,n,a;e=t=o=220,r=n=a=20;var c=getRandomInt(0,7);return c>>0&1&&(e=255,r=10),c>>1&1&&(t=255,n=10),c>>2&1&&(o=255,a=10),e==t&&t==o&&(e=255===e?220:255,r=255===r?20:10),{r:e,g:t,b:o,r_step:r,g_step:n,b_step:a}}function getMappings(t){var r=getColorTheme();setColorTheme(r),Object.keys(t).forEach(function(o,e){categoryToBookColorMap[o]="rgb(".concat(r.r-=r.r_step,",").concat(r.g-=r.g_step,",").concat(r.b-=r.b_step,")"),categoryToTopicMap[o]=[],categoryToArticleMap[o]=[],t[o].forEach(function(e){var t=Object.keys(e)[0];categoryToTopicMap[o].push(t),e[t].forEach(function(e){e.date=new Date(e.date.replace(/_/g,"-")),e=_objectSpread({},e,{topic:t}),categoryToArticleMap[o].push(e)})})})}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function getSessionStorages(){var o=sessionStorage.getItem("details-tags").split(",");0<o.length&&article_page_content.querySelectorAll("details").forEach(function(e,t){e.open="true"===o[t]});var e=sessionStorage.getItem("scrollY");e&&window.scrollTo(0,e)}function insertArticleExpandBtn(){var e=article_page_content.querySelector(".article__expandBtn");if(e){var o="fa-angle-double-down";e.innerHTML='<i class="fas '.concat(o,'"></i>'),e.addEventListener("click",function(){var t=e.firstChild;article_page_content.querySelectorAll("details").forEach(function(e){e.open=t.classList.contains(o)}),t.classList.toggle(o),t.classList.toggle("fa-angle-double-up")})}}function modifyArticle(e,t){article_page.querySelector(".article__title").textContent=decodeURIComponent(decodeURIComponent(t.title)),article_page.querySelector(".article__metadata-date").setAttribute("datetime",t.date),article_page.querySelector(".article__metadata-date").textContent=dateTo_YYYY_Mon_DD(t.date),article_page.querySelector(".article__metadata-category").textContent="In "+decodeURIComponent(decodeURIComponent(e))+" / "+decodeURIComponent(decodeURIComponent(t.topic))}function moveBookToTop(e){var t=books[books.length-1].querySelector(".bookmark__category");t.textContent=decodeURIComponent(t.dataset.category);for(var o=0;o<books.length;++o)if(books[o].dataset.category===e){var r=books[o];book_list.appendChild(r),(books=book_list.querySelectorAll(".book")).forEach(function(e,t){e.setBookOffset(books.length-1-t)});break}}function setColorTheme(e){document.documentElement.style.setProperty("--theme-color-dark","rgb(".concat(e.r-4*e.r_step,",").concat(e.g-4*e.g_step,",").concat(e.b-4*e.b_step,")")),document.documentElement.style.setProperty("--theme-color-light","rgb(".concat(e.r,",").concat(e.g,",").concat(e.b,")")),document.documentElement.style.setProperty("--theme-color-superlight","rgb(".concat(e.r+1.5*e.r_step,",").concat(e.g+1.5*e.g_step,",").concat(e.b+1.5*e.b_step,")"))}function setSessionStorages(){var t=[];article_page_content.querySelectorAll("details").forEach(function(e){t.push(e.open)}),sessionStorage.setItem("details-tags",t),sessionStorage.setItem("scrollY",window.pageYOffset)}function triggerBookAnimation(){setInterval(function(){if("category"===currentPage){var e=books[books.length-1];e.isMouseOverBook||e.isMouseOverBookmarkCategory||moveBookToTop(books[0].dataset.category)}},4500)}window.addEventListener("beforeunload",function(e){setSessionStorages()}),fetch("/static/json/blog-structure.json",{method:"GET",mode:"no-cors"}).then(function(e){return e.json()}).then(function(e){getMappings(e),dropdown_text.querySelector(".dropdown-container").appendChild(createDropdown()),Object.keys(categoryToTopicMap).forEach(function(e,t){var o=new MyBook(e,categoryToTopicMap[e],categoryToArticleMap[e],categoryToBookColorMap[e],t);book_list.insertBefore(o,book_list.firstChild)}),books=book_list.querySelectorAll(".book"),triggerBookAnimation(),pathname_category&&checkCategoryURL()}).catch(function(e){return console.error("Error: "+e)});